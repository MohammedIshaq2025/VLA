========================================
SE(3) ZOO ADVERSARIAL ATTACK EXPERIMENT
========================================
Experiment Name: exp3_500_queries
SLURM Job ID: 2278
Start Time: Mon Jan 19 13:06:05 +03 2026
Suite: libero_spatial
Task IDs: 0
Train Ratio: 0.7
Queries: 500
Target Type: generic
ASR Threshold: 0.5
Learning Rate: 0.01
Seed: 42
========================================
Mon Jan 19 13:06:05 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 580.65.06              Driver Version: 580.65.06      CUDA Version: 13.0     |
+-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H200                    On  |   00000000:BB:00.0 Off |                   On |
| N/A   25C    P0             76W /  700W |      87MiB / 143771MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| MIG devices:                                                                            |
+------------------+----------------------------------+-----------+-----------------------+
| GPU  GI  CI  MIG |              Shared Memory-Usage |        Vol|        Shared         |
|      ID  ID  Dev |                Shared BAR1-Usage | SM     Unc| CE ENC  DEC  OFA  JPG |
|                  |                                  |        ECC|                       |
|==================+==================================+===========+=======================|
|  0    3   0   0  |              29MiB / 33280MiB    | 32      0 |  2   0    2    0    2 |
|                  |               0MiB / 29618MiB    |           |                       |
+------------------+----------------------------------+-----------+-----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Python: /data1/ma1/envs/upa-vla/bin/python3.10
Python 3.10.19


======================================
TASK 0
======================================
[TRAINING] Task 0 starting...
================================================================================
SE(3) ZOO ADVERSARIAL PATCH TRAINING
================================================================================
Run ID:           exp3_500_queries_task0_20260119_130611
Start time:       2026-01-19 13:06:11
Suite:            libero_spatial
Task ID:          0
Train ratio:      0.7 (35/50 episodes)
Query budget:     500
Patch size:       32x32
Learning rate:    0.01
Perturbation:     0.1
Target type:      generic
ASR threshold:    0.5
Device:           cuda:0
Seed:             42
================================================================================
GPU:              NVIDIA H200 MIG 2g.35gb (34.9 GB)

[1/4] Loading LIBERO data...
[info] using task orders [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
  Task:           pick_up_the_black_bowl_between_the_plate_and_the_ramekin_and_place_it_on_the_plate
  Instruction:    pick up the black bowl between the plate and the ramekin and place it on the plate
  Total episodes: 50
  Train episodes: 35 (indices: [0, 3, 4, 9, 10]...)
  Test episodes:  15 (indices: [1, 2, 5, 6, 7]...)

[2/4] Loading OpenVLA model...
[OpenVLA] Loading model from /data1/ma1/Ishaq/ump-vla/checkpoints/openvla-7b on cuda:0...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  5.48it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  6.52it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  7.29it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  6.96it/s]
[OpenVLA] Model loaded successfully
[OpenVLA] Action dim: 7

[3/4] Setting up optimization...
  Target:         Generic failure (invert gripper + position offset)

[4/4] Training adversarial patch...
================================================================================

[ZOO] Starting SE(3) Manifold Attack
[ZOO] Query budget: 500
[ZOO] Learning rate: 0.01, Perturbation scale: 0.1
[ZOO] Early stop: 95.0% ASR for 50 steps
[ZOO] ASR threshold (SE3 distance): 0.5
[ZOO] Training on 35 episodes

[ZOO] Q    0/500 | Loss: 1.051 (avg:1.051) | ASR: 0% (avg:0%) | Δgrip: 0.000 (avg:0.000) | GPU: 15.2GB
[ZOO] Q   10/500 | Loss: 2.486 (avg:1.947) | ASR: 0% (avg:55%) | Δgrip: 0.000 (avg:0.543) | GPU: 15.2GB
[ZOO] Q   20/500 | Loss: 1.590 (avg:1.899) | ASR: 50% (avg:52%) | Δgrip: 0.518 (avg:0.523) | GPU: 15.2GB
[ZOO] Q   30/500 | Loss: 2.146 (avg:1.992) | ASR: 100% (avg:42%) | Δgrip: 0.996 (avg:0.423) | GPU: 15.2GB
[ZOO] Q   40/500 | Loss: 3.017 (avg:2.068) | ASR: 100% (avg:50%) | Δgrip: 0.996 (avg:0.498) | GPU: 15.2GB
[ZOO] Q   50/500 | Loss: 1.583 (avg:1.883) | ASR: 50% (avg:55%) | Δgrip: 0.498 (avg:0.548) | GPU: 15.2GB
[ZOO] Q   60/500 | Loss: 1.936 (avg:1.752) | ASR: 100% (avg:55%) | Δgrip: 0.996 (avg:0.547) | GPU: 15.2GB
[ZOO] Q   70/500 | Loss: 0.814 (avg:2.018) | ASR: 0% (avg:55%) | Δgrip: 0.000 (avg:0.545) | GPU: 15.2GB
[ZOO] Q   80/500 | Loss: 1.053 (avg:2.232) | ASR: 100% (avg:45%) | Δgrip: 0.996 (avg:0.446) | GPU: 15.2GB
[ZOO] Q   90/500 | Loss: 1.083 (avg:1.878) | ASR: 0% (avg:50%) | Δgrip: 0.000 (avg:0.498) | GPU: 15.2GB
[ZOO] Q  100/500 | Loss: 2.855 (avg:1.697) | ASR: 0% (avg:50%) | Δgrip: 0.000 (avg:0.498) | GPU: 15.2GB
[ZOO] Q  110/500 | Loss: 1.021 (avg:1.590) | ASR: 0% (avg:40%) | Δgrip: 0.000 (avg:0.386) | GPU: 15.2GB
[ZOO] Q  120/500 | Loss: 2.962 (avg:1.643) | ASR: 100% (avg:42%) | Δgrip: 0.996 (avg:0.411) | GPU: 15.2GB
[ZOO] Q  130/500 | Loss: 1.947 (avg:1.637) | ASR: 0% (avg:38%) | Δgrip: 0.000 (avg:0.374) | GPU: 15.2GB
[ZOO] Q  140/500 | Loss: 2.388 (avg:1.536) | ASR: 0% (avg:38%) | Δgrip: 0.000 (avg:0.372) | GPU: 15.2GB
[ZOO] Q  150/500 | Loss: 2.997 (avg:1.971) | ASR: 0% (avg:50%) | Δgrip: 0.000 (avg:0.496) | GPU: 15.2GB
[ZOO] Q  160/500 | Loss: 2.871 (avg:2.255) | ASR: 100% (avg:48%) | Δgrip: 0.957 (avg:0.471) | GPU: 15.2GB
[ZOO] Q  170/500 | Loss: 1.097 (avg:1.892) | ASR: 0% (avg:45%) | Δgrip: 0.000 (avg:0.445) | GPU: 15.2GB
[ZOO] Q  180/500 | Loss: 2.269 (avg:1.663) | ASR: 50% (avg:45%) | Δgrip: 0.498 (avg:0.447) | GPU: 15.2GB
[ZOO] Q  190/500 | Loss: 1.032 (avg:1.786) | ASR: 100% (avg:38%) | Δgrip: 0.996 (avg:0.375) | GPU: 15.2GB
[ZOO] Q  200/500 | Loss: 1.565 (avg:1.755) | ASR: 0% (avg:28%) | Δgrip: 0.000 (avg:0.277) | GPU: 15.2GB
[ZOO] Q  210/500 | Loss: 2.785 (avg:1.673) | ASR: 0% (avg:10%) | Δgrip: 0.000 (avg:0.102) | GPU: 15.2GB
[ZOO] Q  220/500 | Loss: 2.304 (avg:1.721) | ASR: 0% (avg:8%) | Δgrip: 0.000 (avg:0.075) | GPU: 15.2GB
[ZOO] Q  230/500 | Loss: 2.050 (avg:1.843) | ASR: 0% (avg:28%) | Δgrip: 0.000 (avg:0.274) | GPU: 15.2GB
[ZOO] Q  240/500 | Loss: 0.183 (avg:1.879) | ASR: 0% (avg:40%) | Δgrip: 0.000 (avg:0.397) | GPU: 15.2GB
[ZOO] Q  250/500 | Loss: 2.032 (avg:1.965) | ASR: 100% (avg:60%) | Δgrip: 0.996 (avg:0.593) | GPU: 15.2GB
[ZOO] Q  260/500 | Loss: 2.335 (avg:1.946) | ASR: 50% (avg:57%) | Δgrip: 0.498 (avg:0.570) | GPU: 15.2GB
[ZOO] Q  270/500 | Loss: 1.798 (avg:1.557) | ASR: 0% (avg:40%) | Δgrip: 0.000 (avg:0.398) | GPU: 15.2GB
[ZOO] Q  280/500 | Loss: 3.186 (avg:1.652) | ASR: 0% (avg:30%) | Δgrip: 0.000 (avg:0.299) | GPU: 15.2GB
[ZOO] Q  290/500 | Loss: 2.216 (avg:1.970) | ASR: 100% (avg:38%) | Δgrip: 0.996 (avg:0.374) | GPU: 15.2GB
[ZOO] Q  300/500 | Loss: 2.979 (avg:1.796) | ASR: 0% (avg:50%) | Δgrip: 0.000 (avg:0.498) | GPU: 15.2GB
[ZOO] Q  310/500 | Loss: 2.263 (avg:1.889) | ASR: 0% (avg:38%) | Δgrip: 0.000 (avg:0.366) | GPU: 15.2GB
[ZOO] Q  320/500 | Loss: 2.479 (avg:2.369) | ASR: 100% (avg:38%) | Δgrip: 0.996 (avg:0.366) | GPU: 15.2GB
[ZOO] Q  330/500 | Loss: 2.068 (avg:2.218) | ASR: 100% (avg:60%) | Δgrip: 0.996 (avg:0.595) | GPU: 15.2GB
[ZOO] Q  340/500 | Loss: 1.968 (avg:1.533) | ASR: 0% (avg:60%) | Δgrip: 0.000 (avg:0.595) | GPU: 15.2GB
[ZOO] Q  350/500 | Loss: 2.100 (avg:1.617) | ASR: 0% (avg:25%) | Δgrip: 0.000 (avg:0.249) | GPU: 15.2GB
[ZOO] Q  360/500 | Loss: 2.982 (avg:1.831) | ASR: 0% (avg:28%) | Δgrip: 0.000 (avg:0.274) | GPU: 15.2GB
[ZOO] Q  370/500 | Loss: 1.209 (avg:1.978) | ASR: 100% (avg:40%) | Δgrip: 0.996 (avg:0.398) | GPU: 15.2GB
[ZOO] Q  380/500 | Loss: 2.882 (avg:2.161) | ASR: 0% (avg:30%) | Δgrip: 0.000 (avg:0.299) | GPU: 15.2GB
[ZOO] Q  390/500 | Loss: 0.452 (avg:1.827) | ASR: 100% (avg:38%) | Δgrip: 0.996 (avg:0.355) | GPU: 15.2GB
[ZOO] Q  400/500 | Loss: 2.576 (avg:1.677) | ASR: 50% (avg:48%) | Δgrip: 0.498 (avg:0.454) | GPU: 15.2GB
[ZOO] Q  410/500 | Loss: 1.109 (avg:1.591) | ASR: 0% (avg:42%) | Δgrip: 0.000 (avg:0.423) | GPU: 15.2GB
[ZOO] Q  420/500 | Loss: 1.156 (avg:1.594) | ASR: 0% (avg:28%) | Δgrip: 0.000 (avg:0.274) | GPU: 15.2GB
[ZOO] Q  430/500 | Loss: 2.786 (avg:1.766) | ASR: 100% (avg:25%) | Δgrip: 0.996 (avg:0.248) | GPU: 15.2GB
[ZOO] Q  440/500 | Loss: 0.710 (avg:1.715) | ASR: 50% (avg:45%) | Δgrip: 0.498 (avg:0.447) | GPU: 15.2GB
[ZOO] Q  450/500 | Loss: 2.210 (avg:1.588) | ASR: 0% (avg:50%) | Δgrip: 0.000 (avg:0.498) | GPU: 15.2GB
[ZOO] Q  460/500 | Loss: 2.552 (avg:2.080) | ASR: 100% (avg:42%) | Δgrip: 0.996 (avg:0.423) | GPU: 15.2GB
[ZOO] Q  470/500 | Loss: 1.353 (avg:2.120) | ASR: 0% (avg:45%) | Δgrip: 0.000 (avg:0.445) | GPU: 15.2GB
[ZOO] Q  480/500 | Loss: 1.447 (avg:1.881) | ASR: 50% (avg:62%) | Δgrip: 0.498 (avg:0.619) | GPU: 15.2GB
[ZOO] Q  490/500 | Loss: 1.580 (avg:2.113) | ASR: 50% (avg:60%) | Δgrip: 0.498 (avg:0.596) | GPU: 15.2GB

[ZOO] Training Complete!
[ZOO] Total queries: 500
[ZOO] Best loss: 0.1499
[ZOO] Best ASR: 100.0%
[ZOO] Final avg loss (last 20): 1.9631
[ZOO] Final avg ASR (last 20): 40.0%
[ZOO] Final avg gripper change: 0.3965
================================================================================

Training Complete!
  Total time:     268.7 seconds (4.5 min)
  Total queries:  500
  Best ASR:       100.0%
  Best loss:      0.1499

[SAVED] Best patch: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/exp3_500_queries_task0_20260119_130611_patch.npy
[SAVED] Patch image: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/exp3_500_queries_task0_20260119_130611_patch.png
[SAVED] Training results: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/results/exp3_500_queries_task0_20260119_130611_training.json

================================================================================
TRAINING SUMMARY
================================================================================
Run ID:           exp3_500_queries_task0_20260119_130611
Suite/Task:       libero_spatial / task_0
Train episodes:   35
Queries used:     500
Training time:    268.7s (4.5 min)
--------------------------------------------------------------------------------
Best ASR:         100.0%
Best loss:        0.1499
Loss reduction:   1.0513 → 1.8451
Dist to target:   1.0513 → 1.8451
Dist to clean:    0.0419 → 0.4136
--------------------------------------------------------------------------------
Patch saved:      /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/exp3_500_queries_task0_20260119_130611_patch.npy
Results saved:    /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/results/exp3_500_queries_task0_20260119_130611_training.json
================================================================================
Final GPU memory: 15.2 GB

End time: 2026-01-19 13:10:49
[TRAINING] Task 0 completed in 285s
[FOUND] Patch: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/exp3_500_queries_task0_20260119_130611_patch.npy

[TESTING] Task 0 starting...
================================================================================
SE(3) ZOO ADVERSARIAL PATCH TESTING
================================================================================
Run ID:           exp3_500_queries_task0_20260119_130611
Start time:       2026-01-19 13:10:55
Patch:            /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/exp3_500_queries_task0_20260119_130611_patch.npy
Suite:            libero_spatial
Task ID:          0
Train ratio:      0.7
Frames/episode:   10
ASR threshold:    0.5
Gripper thresh:   1.0
Target type:      generic
Seed:             42
================================================================================

[1/4] Loading adversarial patch...
  Shape:          (32, 32, 3)
  Range:          [0.300, 0.700]

[2/4] Loading LIBERO data...
[info] using task orders [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
  Task:           pick_up_the_black_bowl_between_the_plate_and_the_ramekin_and_place_it_on_the_plate
  Instruction:    pick up the black bowl between the plate and the ramekin and place it on the plate
  Total episodes: 50
  Test episodes:  15 (indices: [1, 2, 5, 6, 7]...)

[3/4] Loading OpenVLA model...
[OpenVLA] Loading model from /data1/ma1/Ishaq/ump-vla/checkpoints/openvla-7b on cuda:0...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  5.20it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  6.25it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  7.05it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  6.70it/s]
[OpenVLA] Model loaded successfully
[OpenVLA] Action dim: 7

[4/4] Evaluating patch on 15 test episodes...
================================================================================
[TEST] Episode   1/15 | ASR:  40.0% | TaskFail:   0.0% | PatchEff: 0.4842 | GripFlip:   0.0%
[TEST] Episode   3/15 | ASR:  70.0% | TaskFail:   0.0% | PatchEff: 0.7621 | GripFlip:   0.0%
[TEST] Episode   6/15 | ASR:  30.0% | TaskFail:   0.0% | PatchEff: 0.3623 | GripFlip:   0.0%
[TEST] Episode   9/15 | ASR:  70.0% | TaskFail:   0.0% | PatchEff: 0.7983 | GripFlip:   0.0%
[TEST] Episode  12/15 | ASR:  20.0% | TaskFail:  10.0% | PatchEff: 0.2856 | GripFlip:   0.0%
[TEST] Episode  15/15 | ASR:  50.0% | TaskFail:   0.0% | PatchEff: 0.5631 | GripFlip:   0.0%
================================================================================

Testing Complete!
  Total time:     54.1 seconds (0.9 min)
  Episodes:       15
  Frames/episode: 10
  Total frames:   150

================================================================================
TESTING RESULTS
================================================================================

[PRIMARY METRICS]
  ASR:                    46.7% ± 49.9%
  Task Failure ASR:        4.0%
  (Threshold:            0.5 SE(3) distance)

[PATCH EFFECT METRICS]
  Avg Patch Effect:      0.5467 ± 0.5005
  Avg Position Change:   0.0206
  Avg Rotation Change:   0.0612
  Avg Gripper Change:    0.4648

[SUCCESS RATES]
  Gripper Flip Rate:       0.0%
  Deviation Rate:         46.7%
  Target Approach Rate:   39.3%

[BASELINE METRICS]
  Clean Model Error:     2.0120
  Patched Model Error:   1.8931
  Error Change:          -0.1189
================================================================================
⚠️  WEAK EFFECT: 20% <= ASR < 50%
⚠️  LOW GRIPPER FLIP: 0.0% - May not cause task failure
================================================================================

[SAVED] Testing summary: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/results/exp3_500_queries_task0_20260119_130611_testing.json
[SAVED] Detailed results: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/results/exp3_500_queries_task0_20260119_130611_detailed.json

End time: 2026-01-19 13:11:58
[TESTING] Task 0 completed in 69s

[RESULTS] Task 0:
  ASR: 0.4666666666666667
  Gripper Flip Rate: 0.0
  Patch Effect: 0.5466693233692803


========================================
EXPERIMENT COMPLETE
========================================
Experiment: exp3_500_queries
End Time: Mon Jan 19 13:11:59 +03 2026
Summary: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/experiments/exp3_500_queries/results_summary.json
Log: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/experiments/exp3_500_queries/experiment_log.txt
========================================

Results Summary:
[
  {
    "task_id": 0,
    "asr": 0.4666666666666667,
    "gripper_flip_rate": 0.0,
    "patch_effect": 0.5466693233692803,
    "train_time": 285,
    "test_time": 69,
    "patch_path": "/data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/exp3_500_queries_task0_20260119_130611_patch.npy",
    "results_path": "/data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/results/exp3_500_queries_task0_20260119_130611_testing.json"
  }
]
