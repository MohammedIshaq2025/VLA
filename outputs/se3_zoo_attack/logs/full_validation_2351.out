============================================================================================================
FULL VALIDATION PIPELINE - DIRECTION 2 COMPREHENSIVE TEST
============================================================================================================
Pipeline: full_validation_libero_spatial_20260121_033842
Start time: Wed Jan 21 03:38:42 +03 2026
SLURM Job ID: 2351
============================================================================================================
Configuration:
  Suite: libero_spatial
  Task(s): 0
  Queries: 200
============================================================================================================

Wed Jan 21 03:38:42 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 580.65.06              Driver Version: 580.65.06      CUDA Version: 13.0     |
+-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H200                    On  |   00000000:9B:00.0 Off |                   On |
| N/A   29C    P0             76W /  700W |      87MiB / 143771MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| MIG devices:                                                                            |
+------------------+----------------------------------+-----------+-----------------------+
| GPU  GI  CI  MIG |              Shared Memory-Usage |        Vol|        Shared         |
|      ID  ID  Dev |                Shared BAR1-Usage | SM     Unc| CE ENC  DEC  OFA  JPG |
|                  |                                  |        ECC|                       |
|==================+==================================+===========+=======================|
|  0    3   0   0  |              29MiB / 33280MiB    | 32      0 |  2   0    2    0    2 |
|                  |               0MiB / 29618MiB    |           |                       |
+------------------+----------------------------------+-----------+-----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Running full pipeline on 1 task(s): 0

============================================================================================================
STEP 1/5: CLEAN BASELINE (No Attack)
============================================================================================================

----------------------------------------
Task 0: Establishing clean baseline
----------------------------------------
[robosuite WARNING] No private macro file found! (__init__.py:7)
[robosuite WARNING] It is recommended to use a private macro file (__init__.py:8)
[robosuite WARNING] To setup, run: python /data1/ma1/envs/upa-vla/lib/python3.10/site-packages/robosuite/scripts/setup_macros.py (__init__.py:9)
✓ Successfully imported LIBERO
================================================================================
CLOSED-LOOP LIBERO EVALUATION - THE CRITICAL TEST
================================================================================
Experiment: clean_baseline_task0_20260121_033842
Start time: 2026-01-21 03:38:49
Suite: libero_spatial
Tasks: [0]
Clean episodes per task: 50
Attacked episodes per task: 0
Max steps per episode: 300
================================================================================

[1/3] Loading OpenVLA model...
[OpenVLA] Loading model from /data1/ma1/Ishaq/ump-vla/checkpoints/openvla-7b on cuda:0...
[OpenVLA] Step 1/4: Loading processor...
<frozen importlib._bootstrap>:283: DeprecationWarning: the load_module() method is deprecated and slated for removal in Python 3.12; use exec_module() instead
[OpenVLA] ✓ Processor loaded
[OpenVLA] Step 2/4: Loading model weights...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  4.97it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  5.64it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  6.15it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  5.93it/s]
[OpenVLA] ✓ Model weights loaded
[OpenVLA] Step 3/4: Moving model to cuda:0...
[OpenVLA] ✓ Model moved to cuda:0
[OpenVLA] Step 4/4: Getting action dimension...
[OpenVLA] ✓ Model loaded successfully
[OpenVLA] Action dim: 7
✓ Model loaded in 9.3s

[2/3] No patch specified - running clean baseline only

[3/3] Running closed-loop evaluation...

================================================================================
Evaluating Task 0 from libero_spatial
================================================================================
[info] using task orders [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Task Name: pick_up_the_black_bowl_between_the_plate_and_the_ramekin_and_place_it_on_the_plate
Instruction: pick up the black bowl between the plate and the ramekin and place it on the plate
  Using fallback BDDL path: /data1/ma1/envs/upa-vla/lib/python3.10/site-packages/libero/libero/bddl_files/libero_spatial/pick_up_the_black_bowl_between_the_plate_and_the_ramekin_and_place_it_on_the_plate.bddl

[CLEAN POLICY] Running 50 episodes...
Local assets not found. Downloading from HuggingFace Hub...
Assets already downloaded at /data1/ma1/.cache/libero/assets
  Episode 1/50: Success rate so far: 0/1 (0.0%)
  Episode 10/50: Success rate so far: 0/10 (0.0%)
  Episode 20/50: Success rate so far: 0/20 (0.0%)
  Episode 30/50: Success rate so far: 0/30 (0.0%)
  Episode 40/50: Success rate so far: 0/40 (0.0%)
  Episode 50/50: Success rate so far: 0/50 (0.0%)
[CLEAN POLICY] Completed in 7840.5s
[CLEAN POLICY] Success Rate: 0.0% (0/50)

================================================================================
AGGREGATE RESULTS ACROSS ALL TASKS
================================================================================

Mean Clean Success Rate: 0.0% ± 0.0%

✓ Results saved: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/closed_loop/clean_baseline_task0_20260121_033842_results.json

================================================================================
FINAL VERDICT - CLOSED-LOOP EVALUATION
================================================================================
Clean baseline established: 0.0% success rate
================================================================================

End time: 2026-01-21 05:49:39
✅ Clean baseline complete for task 0

STEP 1 completed in 7858s (130 minutes)

============================================================================================================
STEP 2/5: TRAIN BASELINE PATCHES (w_grip=0.1)
============================================================================================================

----------------------------------------
Task 0: Training baseline patch
----------------------------------------
================================================================================
DIRECTION 2: MAXIMIZE DEVIATION ATTACK
================================================================================
Goal: Maximize per-frame deviation for closed-loop trajectory attack
================================================================================
Run ID:           baseline_patch_task0_20260121_033842_20260121_054946
Start time:       2026-01-21 05:49:46
Suite:            libero_spatial
Task ID:          0
Train ratio:      0.7 (35/50 episodes)
Query budget:     200
Mini-batch size:  3
Patch size:       32x32
Patch position:   (48, 48)
Learning rate:    0.01
Perturbation σ:   0.1
Deviation thresh: 0.3
Weights:          pos=1.0, rot=0.5, grip=0.1
Position-only:    False
Use normalized:   True
Device:           cuda:0
Seed:             42
================================================================================
GPU:              NVIDIA H200 MIG 2g.35gb (34.9 GB)

[1/3] Loading LIBERO data...
[info] using task orders [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
  Task:           pick_up_the_black_bowl_between_the_plate_and_the_ramekin_and_place_it_on_the_plate
  Instruction:    pick up the black bowl between the plate and the ramekin and place it on the plate
  Total episodes: 50
  Train episodes: 35 (indices: [0, 3, 4, 9, 10]...)
  Test episodes:  15 (indices: [1, 2, 5, 6, 7]...)

[2/3] Loading OpenVLA model...
[OpenVLA] Loading model from /data1/ma1/Ishaq/ump-vla/checkpoints/openvla-7b on cuda:0...
[OpenVLA] Step 1/4: Loading processor...
[OpenVLA] ✓ Processor loaded
[OpenVLA] Step 2/4: Loading model weights...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  5.40it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  6.38it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  6.78it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  7.11it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  6.79it/s]
[OpenVLA] ✓ Model weights loaded
[OpenVLA] Step 3/4: Moving model to cuda:0...
[OpenVLA] ✓ Model moved to cuda:0
[OpenVLA] Step 4/4: Getting action dimension...
[OpenVLA] ✓ Model loaded successfully
[OpenVLA] Action dim: 7

[3/3] Initializing ZOO V2 Optimizer...

======================================================================
ZOO V2: MAXIMIZE DEVIATION ATTACK (Direction 2 Aligned)
======================================================================
Goal: Maximize deviation from clean predictions
Mode: NORMALIZED SE(3) (scale-invariant)
======================================================================
Query budget:     200
Mini-batch size:  3
Learning rate:    0.01
Perturbation σ:   0.1
Patch size:       32x32
Patch position:   (48, 48)
Weights:          pos=1.0, rot=0.5, grip=0.1
Position-only:    False
Use normalized:   True
Deviation thresh: 0.3
Training episodes:35
Seed:             42
======================================================================

[Q    0/200] Dev: 0.7007 (avg: 0.7007) | Rate:  66.7% (avg: 66.7%) | Best: 0.7007 | Grad: 0.0000
[Q   10/200] Dev: 1.0433 (avg: 0.5029) | Rate: 100.0% (avg: 45.5%) | Best: 0.7007 | Grad: 0.0000
[Q   20/200] Dev: 0.7357 (avg: 0.5883) | Rate:  66.7% (avg: 55.0%) | Best: 0.7007 | Grad: 0.0488
[Q   30/200] Dev: 0.4007 (avg: 0.5888) | Rate:  66.7% (avg: 58.3%) | Best: 0.7007 | Grad: 0.1992
[Q   40/200] Dev: 0.5315 (avg: 0.4916) | Rate:  66.7% (avg: 50.0%) | Best: 0.7007 | Grad: 0.0830
[Q   50/200] Dev: 0.5355 (avg: 0.5198) | Rate:  66.7% (avg: 50.0%) | Best: 0.7007 | Grad: 0.0788
[Q   60/200] Dev: 0.0721 (avg: 0.4655) | Rate:   0.0% (avg: 45.0%) | Best: 0.7007 | Grad: 0.0000
[Q   70/200] Dev: 0.3880 (avg: 0.3322) | Rate:  33.3% (avg: 30.0%) | Best: 0.7007 | Grad: 0.2007
[Q   80/200] Dev: 0.4108 (avg: 0.4606) | Rate:  33.3% (avg: 40.0%) | Best: 0.7007 | Grad: 1.0947
[Q   90/200] Dev: 0.1092 (avg: 0.5453) | Rate:   0.0% (avg: 50.0%) | Best: 0.7007 | Grad: 0.3673
[Q  100/200] Dev: 0.7150 (avg: 0.5081) | Rate:  66.7% (avg: 48.3%) | Best: 0.7007 | Grad: 0.0059
[Q  110/200] Dev: 0.0405 (avg: 0.4554) | Rate:   0.0% (avg: 43.3%) | Best: 0.7007 | Grad: 0.0000
[Q  120/200] Dev: 0.3851 (avg: 0.4301) | Rate:  33.3% (avg: 38.3%) | Best: 0.7007 | Grad: 0.2668
[Q  130/200] Dev: 1.0673 (avg: 0.5388) | Rate: 100.0% (avg: 50.0%) | Best: 0.7007 | Grad: 0.0000
[Q  140/200] Dev: 0.7848 (avg: 0.5211) | Rate:  66.7% (avg: 48.3%) | Best: 0.7007 | Grad: 0.1595
[Q  150/200] Dev: 1.0971 (avg: 0.5206) | Rate: 100.0% (avg: 48.3%) | Best: 0.7007 | Grad: 0.3244
[Q  160/200] Dev: 0.4264 (avg: 0.5850) | Rate:  33.3% (avg: 55.0%) | Best: 0.7007 | Grad: 0.1967
[Q  170/200] Dev: 0.2696 (avg: 0.6051) | Rate:  33.3% (avg: 60.0%) | Best: 0.7007 | Grad: 0.3431
[Q  180/200] Dev: 0.7522 (avg: 0.6165) | Rate:  66.7% (avg: 60.0%) | Best: 0.7007 | Grad: 0.0702
[Q  190/200] Dev: 1.1025 (avg: 0.6632) | Rate: 100.0% (avg: 60.0%) | Best: 0.7007 | Grad: 0.0000
[Q  199/200] Dev: 0.4147 (avg: 0.5881) | Rate:  33.3% (avg: 55.0%) | Best: 0.7007 | Grad: 0.0000

======================================================================
TRAINING COMPLETE
======================================================================
Total queries:        200
Training time:        483.3s (8.1 min)
Best avg deviation:   0.7007
Final avg deviation:  0.5881
Final deviation rate: 55.0%
======================================================================

================================================================================
Training Complete!
  Total time:         483.3 seconds (8.1 min)
  Total queries:      200
  Best avg deviation: 0.7007
================================================================================

[SAVED] Best patch: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/baseline_patch_task0_20260121_033842_20260121_054946_patch.npy
[SAVED] Patch image: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/baseline_patch_task0_20260121_033842_20260121_054946_patch.png
[SAVED] Training results: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/results/baseline_patch_task0_20260121_033842_20260121_054946_training.json

================================================================================
TRAINING SUMMARY (Direction 2: Maximize Deviation)
================================================================================
Run ID:              baseline_patch_task0_20260121_033842_20260121_054946
Suite/Task:          libero_spatial / task_0
Train episodes:      35
Queries used:        200
Training time:       483.3s (8.1 min)
--------------------------------------------------------------------------------
DEVIATION METRICS (key for Direction 2):
  Best avg deviation:  0.7007
  Initial deviation:   0.7007
  Final deviation:     0.5230
  Deviation rate:      50.0%
--------------------------------------------------------------------------------
Patch saved:         /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/baseline_patch_task0_20260121_033842_20260121_054946_patch.npy
Results saved:       /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/results/baseline_patch_task0_20260121_033842_20260121_054946_training.json
================================================================================
Final GPU memory: 15.2 GB

End time: 2026-01-21 05:57:58
✅ Baseline patch trained: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/baseline_patch_task0_20260121_033842_20260121_054946_patch.npy
================================================================================
DIRECTION 2: DEVIATION ANALYSIS TESTING
================================================================================
Focus: Measuring deviation from clean predictions
Goal: Validate patch effect for closed-loop trajectory attack
================================================================================
Run ID:           baseline_task0_20260121_033842_20260121_054946
Start time:       2026-01-21 05:58:05
Patch:            /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/baseline_patch_task0_20260121_033842_20260121_054946_patch.npy
Patch position:   (48, 48)
Suite:            libero_spatial
Task ID:          0
Train ratio:      0.7
Frames/episode:   10
Deviation thresh: 0.3
Drift threshold:  0.05m (for CDT)
Task scale:       0.5m (for TFP)
SDR windows:      [3, 5, 10]
Seed:             42
================================================================================

[1/4] Loading adversarial patch...
  Shape:          (32, 32, 3)
  Range:          [0.300, 0.700]

[2/4] Loading LIBERO data...
[info] using task orders [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
  Task:           pick_up_the_black_bowl_between_the_plate_and_the_ramekin_and_place_it_on_the_plate
  Instruction:    pick up the black bowl between the plate and the ramekin and place it on the plate
  Total episodes: 50
  Test episodes:  15 (indices: [1, 2, 5, 6, 7]...)

[3/4] Loading OpenVLA model...
[OpenVLA] Loading model from /data1/ma1/Ishaq/ump-vla/checkpoints/openvla-7b on cuda:0...
[OpenVLA] Step 1/4: Loading processor...
[OpenVLA] ✓ Processor loaded
[OpenVLA] Step 2/4: Loading model weights...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  5.97it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  6.18it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  6.98it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  6.72it/s]
[OpenVLA] ✓ Model weights loaded
[OpenVLA] Step 3/4: Moving model to cuda:0...
[OpenVLA] ✓ Model moved to cuda:0
[OpenVLA] Step 4/4: Getting action dimension...
[OpenVLA] ✓ Model loaded successfully
[OpenVLA] Action dim: 7

[4/4] Evaluating patch on 15 test episodes...
================================================================================
[TEST] Episode   1/15 | Avg Dev: 0.5856 | Cumul: 5.8555 | Rate:  50.0% | Pos: 0.0191
[TEST] Episode   3/15 | Avg Dev: 0.7716 | Cumul: 7.7164 | Rate:  70.0% | Pos: 0.0164
[TEST] Episode   6/15 | Avg Dev: 0.5644 | Cumul: 5.6440 | Rate:  50.0% | Pos: 0.0218
[TEST] Episode   9/15 | Avg Dev: 0.8998 | Cumul: 8.9981 | Rate:  80.0% | Pos: 0.0244
[TEST] Episode  12/15 | Avg Dev: 0.4740 | Cumul: 4.7398 | Rate:  40.0% | Pos: 0.0223
[TEST] Episode  15/15 | Avg Dev: 0.4633 | Cumul: 4.6335 | Rate:  40.0% | Pos: 0.0193
================================================================================

Testing Complete!
  Total time:     54.3 seconds (0.9 min)
  Episodes:       15
  Frames/episode: 10
  Total frames:   150

================================================================================
DIRECTION 2 TESTING RESULTS: DEVIATION ANALYSIS
================================================================================

[PRIMARY METRICS: DEVIATION FROM CLEAN PREDICTION]
  Average Deviation:     0.5771 +/- 0.5036
  Deviation Rate:         50.0% (threshold: 0.3)
  Max Deviation:         1.1733
  Min Deviation:         0.0164

[COMPONENT-WISE DEVIATIONS]
  Position Deviation:    0.0208 (meters)
  Rotation Deviation:    0.0593 (radians)
  Gripper Deviation:     0.4970 (0-2 scale)

[CUMULATIVE METRICS (Proxy for Closed-Loop Impact)]
  Avg Episode Cumulative: 5.7714
  Total Cumulative:       86.5714
  Cumulative Position:    3.1261 meters

[BASELINE CONTEXT (for reference)]
  Clean Model GT Error:   2.0120
  Patched Model GT Error: 1.9015
  GT Error Change:        -0.1105
================================================================================

================================================================================
TRAJECTORY-LEVEL METRICS (Sequential Attack Evaluation)
================================================================================

[CDT - Cumulative Drift Threshold (threshold: 0.05m)]
  Success Rate:     66.7%
  Episodes Success: 10/15

[TTF - Time-to-Failure (frames to exceed 0.05m drift)]
  Mean TTF:         5.5 frames
  Min TTF:          3 frames
  Max TTF:          10 frames
  TTF Success Rate: 86.7%

[SDR - Sustained Deviation Rate (mean dev > 0.3 per window)]
  Window   3 frames: 90.8%
  Window   5 frames: 85.6%
  Window  10 frames: 93.3%

[TFP - Task Failure Proxy (actual_drift / task_scale=0.5m)]
  Mean TFP Score:   0.14x task scale
  Max TFP Score:    0.23x task scale
  TFP > 1.0 Rate:   0.0% of episodes

[ACTUAL TRAJECTORY DRIFT (||Σ Δ|| - the CORRECT metric)]
  Mean Actual Drift:    0.0677m
  Max Actual Drift:     0.1159m
  Drift Consistency:    0.32
    (1.0 = all deviations same direction, <0.5 = significant oscillation)

[LEGACY CUMULATIVE DRIFT (Σ ||Δ|| - for comparison only)]
  Mean Legacy Drift:    0.2084m
  Max Legacy Drift:     0.2926m

  ⚠️  WARNING: Low drift consistency (0.32)
      Attack may be oscillating - deviations canceling out!
      Actual drift (0.0677m) << Legacy (0.2084m)
================================================================================

[DIRECTION 2 OVERALL ASSESSMENT]
  STRONG DEVIATION: 0.5771 >= 0.5
  -> High per-frame deviation suggests significant closed-loop impact

  Cumulative Position Drift: 3.1261m over 150 frames
  Projected Drift (100 frames): 2.0841m
  -> Significant trajectory drift expected in closed-loop execution
================================================================================

[SAVED] Testing summary: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/results/baseline_task0_20260121_033842_20260121_054946_testing.json
[SAVED] Detailed results: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/results/baseline_task0_20260121_033842_20260121_054946_detailed.json

End time: 2026-01-21 05:59:08

STEP 2 completed in 569s (9 minutes)

============================================================================================================
STEP 3/5: TRAIN GRIPPER-FOCUSED PATCHES (w_grip=5.0)
============================================================================================================

----------------------------------------
Task 0: Training gripper-focused patch
----------------------------------------
================================================================================
DIRECTION 2: MAXIMIZE DEVIATION ATTACK
================================================================================
Goal: Maximize per-frame deviation for closed-loop trajectory attack
================================================================================
Run ID:           gripper_focused_task0_20260121_033842_20260121_055913
Start time:       2026-01-21 05:59:13
Suite:            libero_spatial
Task ID:          0
Train ratio:      0.7 (35/50 episodes)
Query budget:     200
Mini-batch size:  3
Patch size:       32x32
Patch position:   (48, 48)
Learning rate:    0.01
Perturbation σ:   0.1
Deviation thresh: 0.3
Weights:          pos=1.0, rot=0.5, grip=5.0
Position-only:    False
Use normalized:   True
Device:           cuda:0
Seed:             42
================================================================================
GPU:              NVIDIA H200 MIG 2g.35gb (34.9 GB)

[1/3] Loading LIBERO data...
[info] using task orders [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
  Task:           pick_up_the_black_bowl_between_the_plate_and_the_ramekin_and_place_it_on_the_plate
  Instruction:    pick up the black bowl between the plate and the ramekin and place it on the plate
  Total episodes: 50
  Train episodes: 35 (indices: [0, 3, 4, 9, 10]...)
  Test episodes:  15 (indices: [1, 2, 5, 6, 7]...)

[2/3] Loading OpenVLA model...
[OpenVLA] Loading model from /data1/ma1/Ishaq/ump-vla/checkpoints/openvla-7b on cuda:0...
[OpenVLA] Step 1/4: Loading processor...
[OpenVLA] ✓ Processor loaded
[OpenVLA] Step 2/4: Loading model weights...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  5.92it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  6.65it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  7.20it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  6.96it/s]
[OpenVLA] ✓ Model weights loaded
[OpenVLA] Step 3/4: Moving model to cuda:0...
[OpenVLA] ✓ Model moved to cuda:0
[OpenVLA] Step 4/4: Getting action dimension...
[OpenVLA] ✓ Model loaded successfully
[OpenVLA] Action dim: 7

[3/3] Initializing ZOO V2 Optimizer...

======================================================================
ZOO V2: MAXIMIZE DEVIATION ATTACK (Direction 2 Aligned)
======================================================================
Goal: Maximize deviation from clean predictions
Mode: NORMALIZED SE(3) (scale-invariant)
======================================================================
Query budget:     200
Mini-batch size:  3
Learning rate:    0.01
Perturbation σ:   0.1
Patch size:       32x32
Patch position:   (48, 48)
Weights:          pos=1.0, rot=0.5, grip=5.0
Position-only:    False
Use normalized:   True
Deviation thresh: 0.3
Training episodes:35
Seed:             42
======================================================================

[Q    0/200] Dev: 0.7007 (avg: 0.7007) | Rate:  66.7% (avg: 66.7%) | Best: 0.7007 | Grad: 0.0000
[Q   10/200] Dev: 1.0433 (avg: 0.5029) | Rate: 100.0% (avg: 45.5%) | Best: 0.7007 | Grad: 0.0000
[Q   20/200] Dev: 0.7328 (avg: 0.5980) | Rate:  66.7% (avg: 55.0%) | Best: 0.7007 | Grad: 0.0000
[Q   30/200] Dev: 0.2189 (avg: 0.6236) | Rate:  33.3% (avg: 60.0%) | Best: 0.7007 | Grad: 4.2131
[Q   40/200] Dev: 0.5804 (avg: 0.4878) | Rate:  66.7% (avg: 48.3%) | Best: 0.7007 | Grad: 4.0681
[Q   50/200] Dev: 0.7489 (avg: 0.4812) | Rate:  66.7% (avg: 45.0%) | Best: 0.7007 | Grad: 0.3193
[Q   60/200] Dev: 0.7181 (avg: 0.5139) | Rate:  66.7% (avg: 46.7%) | Best: 0.7007 | Grad: 0.0003
[Q   70/200] Dev: 0.4191 (avg: 0.3723) | Rate:  33.3% (avg: 31.7%) | Best: 0.7007 | Grad: 0.0000
[Q   80/200] Dev: 0.4100 (avg: 0.4352) | Rate:  33.3% (avg: 36.7%) | Best: 0.7007 | Grad: 0.0140
[Q   90/200] Dev: 0.0730 (avg: 0.5785) | Rate:   0.0% (avg: 55.0%) | Best: 0.7007 | Grad: 0.0000
[Q  100/200] Dev: 0.5562 (avg: 0.5582) | Rate:  66.7% (avg: 58.3%) | Best: 0.7007 | Grad: 4.0197
[Q  110/200] Dev: 0.0372 (avg: 0.4890) | Rate:   0.0% (avg: 51.7%) | Best: 0.7007 | Grad: 12.6923
[Q  120/200] Dev: 0.8025 (avg: 0.4721) | Rate:  66.7% (avg: 46.7%) | Best: 0.7007 | Grad: 0.4890
[Q  130/200] Dev: 0.7256 (avg: 0.5197) | Rate:  66.7% (avg: 51.7%) | Best: 0.7007 | Grad: 0.0037
[Q  140/200] Dev: 0.7361 (avg: 0.4562) | Rate:  66.7% (avg: 46.7%) | Best: 0.7007 | Grad: 0.0252
[Q  150/200] Dev: 0.7695 (avg: 0.5074) | Rate:  66.7% (avg: 50.0%) | Best: 0.7007 | Grad: 0.0694
[Q  160/200] Dev: 0.7443 (avg: 0.6237) | Rate: 100.0% (avg: 61.7%) | Best: 0.7007 | Grad: 0.0423
[Q  170/200] Dev: 0.7342 (avg: 0.6117) | Rate:  66.7% (avg: 61.7%) | Best: 0.7007 | Grad: 0.2813
[Q  180/200] Dev: 0.7498 (avg: 0.6323) | Rate:  66.7% (avg: 61.7%) | Best: 0.7007 | Grad: 0.0121
[Q  190/200] Dev: 1.0983 (avg: 0.6337) | Rate: 100.0% (avg: 60.0%) | Best: 0.7007 | Grad: 0.0000
[Q  199/200] Dev: 0.8975 (avg: 0.5799) | Rate: 100.0% (avg: 60.0%) | Best: 0.7007 | Grad: 4.1028

======================================================================
TRAINING COMPLETE
======================================================================
Total queries:        200
Training time:        476.6s (7.9 min)
Best avg deviation:   0.7007
Final avg deviation:  0.5799
Final deviation rate: 60.0%
======================================================================

================================================================================
Training Complete!
  Total time:         476.6 seconds (7.9 min)
  Total queries:      200
  Best avg deviation: 0.7007
================================================================================

[SAVED] Best patch: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/gripper_focused_task0_20260121_033842_20260121_055913_patch.npy
[SAVED] Patch image: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/gripper_focused_task0_20260121_033842_20260121_055913_patch.png
[SAVED] Training results: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/results/gripper_focused_task0_20260121_033842_20260121_055913_training.json

================================================================================
TRAINING SUMMARY (Direction 2: Maximize Deviation)
================================================================================
Run ID:              gripper_focused_task0_20260121_033842_20260121_055913
Suite/Task:          libero_spatial / task_0
Train episodes:      35
Queries used:        200
Training time:       476.6s (7.9 min)
--------------------------------------------------------------------------------
DEVIATION METRICS (key for Direction 2):
  Best avg deviation:  0.7007
  Initial deviation:   0.7007
  Final deviation:     0.6317
  Deviation rate:      70.0%
--------------------------------------------------------------------------------
Patch saved:         /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/gripper_focused_task0_20260121_033842_20260121_055913_patch.npy
Results saved:       /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/results/gripper_focused_task0_20260121_033842_20260121_055913_training.json
================================================================================
Final GPU memory: 15.2 GB

End time: 2026-01-21 06:07:19
✅ Gripper patch trained: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/gripper_focused_task0_20260121_033842_20260121_055913_patch.npy
================================================================================
DIRECTION 2: DEVIATION ANALYSIS TESTING
================================================================================
Focus: Measuring deviation from clean predictions
Goal: Validate patch effect for closed-loop trajectory attack
================================================================================
Run ID:           gripper_focused_task0_20260121_033842_20260121_055913
Start time:       2026-01-21 06:07:25
Patch:            /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/gripper_focused_task0_20260121_033842_20260121_055913_patch.npy
Patch position:   (48, 48)
Suite:            libero_spatial
Task ID:          0
Train ratio:      0.7
Frames/episode:   10
Deviation thresh: 0.3
Drift threshold:  0.05m (for CDT)
Task scale:       0.5m (for TFP)
SDR windows:      [3, 5, 10]
Seed:             42
================================================================================

[1/4] Loading adversarial patch...
  Shape:          (32, 32, 3)
  Range:          [0.300, 0.700]

[2/4] Loading LIBERO data...
[info] using task orders [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
  Task:           pick_up_the_black_bowl_between_the_plate_and_the_ramekin_and_place_it_on_the_plate
  Instruction:    pick up the black bowl between the plate and the ramekin and place it on the plate
  Total episodes: 50
  Test episodes:  15 (indices: [1, 2, 5, 6, 7]...)

[3/4] Loading OpenVLA model...
[OpenVLA] Loading model from /data1/ma1/Ishaq/ump-vla/checkpoints/openvla-7b on cuda:0...
[OpenVLA] Step 1/4: Loading processor...
[OpenVLA] ✓ Processor loaded
[OpenVLA] Step 2/4: Loading model weights...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  5.41it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  6.38it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  6.78it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  7.10it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  6.79it/s]
[OpenVLA] ✓ Model weights loaded
[OpenVLA] Step 3/4: Moving model to cuda:0...
[OpenVLA] ✓ Model moved to cuda:0
[OpenVLA] Step 4/4: Getting action dimension...
[OpenVLA] ✓ Model loaded successfully
[OpenVLA] Action dim: 7

[4/4] Evaluating patch on 15 test episodes...
================================================================================
[TEST] Episode   1/15 | Avg Dev: 0.5856 | Cumul: 5.8555 | Rate:  50.0% | Pos: 0.0191
[TEST] Episode   3/15 | Avg Dev: 0.7716 | Cumul: 7.7164 | Rate:  70.0% | Pos: 0.0164
[TEST] Episode   6/15 | Avg Dev: 0.5644 | Cumul: 5.6440 | Rate:  50.0% | Pos: 0.0218
[TEST] Episode   9/15 | Avg Dev: 0.8998 | Cumul: 8.9981 | Rate:  80.0% | Pos: 0.0244
[TEST] Episode  12/15 | Avg Dev: 0.4740 | Cumul: 4.7398 | Rate:  40.0% | Pos: 0.0223
[TEST] Episode  15/15 | Avg Dev: 0.4633 | Cumul: 4.6335 | Rate:  40.0% | Pos: 0.0193
================================================================================

Testing Complete!
  Total time:     54.1 seconds (0.9 min)
  Episodes:       15
  Frames/episode: 10
  Total frames:   150

================================================================================
DIRECTION 2 TESTING RESULTS: DEVIATION ANALYSIS
================================================================================

[PRIMARY METRICS: DEVIATION FROM CLEAN PREDICTION]
  Average Deviation:     0.5771 +/- 0.5036
  Deviation Rate:         50.0% (threshold: 0.3)
  Max Deviation:         1.1733
  Min Deviation:         0.0164

[COMPONENT-WISE DEVIATIONS]
  Position Deviation:    0.0208 (meters)
  Rotation Deviation:    0.0593 (radians)
  Gripper Deviation:     0.4970 (0-2 scale)

[CUMULATIVE METRICS (Proxy for Closed-Loop Impact)]
  Avg Episode Cumulative: 5.7714
  Total Cumulative:       86.5714
  Cumulative Position:    3.1261 meters

[BASELINE CONTEXT (for reference)]
  Clean Model GT Error:   2.0120
  Patched Model GT Error: 1.9015
  GT Error Change:        -0.1105
================================================================================

================================================================================
TRAJECTORY-LEVEL METRICS (Sequential Attack Evaluation)
================================================================================

[CDT - Cumulative Drift Threshold (threshold: 0.05m)]
  Success Rate:     66.7%
  Episodes Success: 10/15

[TTF - Time-to-Failure (frames to exceed 0.05m drift)]
  Mean TTF:         5.5 frames
  Min TTF:          3 frames
  Max TTF:          10 frames
  TTF Success Rate: 86.7%

[SDR - Sustained Deviation Rate (mean dev > 0.3 per window)]
  Window   3 frames: 90.8%
  Window   5 frames: 85.6%
  Window  10 frames: 93.3%

[TFP - Task Failure Proxy (actual_drift / task_scale=0.5m)]
  Mean TFP Score:   0.14x task scale
  Max TFP Score:    0.23x task scale
  TFP > 1.0 Rate:   0.0% of episodes

[ACTUAL TRAJECTORY DRIFT (||Σ Δ|| - the CORRECT metric)]
  Mean Actual Drift:    0.0677m
  Max Actual Drift:     0.1159m
  Drift Consistency:    0.32
    (1.0 = all deviations same direction, <0.5 = significant oscillation)

[LEGACY CUMULATIVE DRIFT (Σ ||Δ|| - for comparison only)]
  Mean Legacy Drift:    0.2084m
  Max Legacy Drift:     0.2926m

  ⚠️  WARNING: Low drift consistency (0.32)
      Attack may be oscillating - deviations canceling out!
      Actual drift (0.0677m) << Legacy (0.2084m)
================================================================================

[DIRECTION 2 OVERALL ASSESSMENT]
  STRONG DEVIATION: 0.5771 >= 0.5
  -> High per-frame deviation suggests significant closed-loop impact

  Cumulative Position Drift: 3.1261m over 150 frames
  Projected Drift (100 frames): 2.0841m
  -> Significant trajectory drift expected in closed-loop execution
================================================================================

[SAVED] Testing summary: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/results/gripper_focused_task0_20260121_033842_20260121_055913_testing.json
[SAVED] Detailed results: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/results/gripper_focused_task0_20260121_033842_20260121_055913_detailed.json

End time: 2026-01-21 06:08:28

STEP 3 completed in 560s (9 minutes)

============================================================================================================
STEP 4/5: CLOSED-LOOP EVALUATION (THE CRITICAL TEST)
============================================================================================================

==========================================
Task 0: Closed-Loop Evaluation
==========================================
[4a] Evaluating BASELINE patch...
[robosuite WARNING] No private macro file found! (__init__.py:7)
[robosuite WARNING] It is recommended to use a private macro file (__init__.py:8)
[robosuite WARNING] To setup, run: python /data1/ma1/envs/upa-vla/lib/python3.10/site-packages/robosuite/scripts/setup_macros.py (__init__.py:9)
✓ Successfully imported LIBERO
================================================================================
CLOSED-LOOP LIBERO EVALUATION - THE CRITICAL TEST
================================================================================
Experiment: cl_baseline_task0_20260121_033842
Start time: 2026-01-21 06:08:34
Suite: libero_spatial
Tasks: [0]
Clean episodes per task: 50
Attacked episodes per task: 50
Max steps per episode: 300
================================================================================

[1/3] Loading OpenVLA model...
[OpenVLA] Loading model from /data1/ma1/Ishaq/ump-vla/checkpoints/openvla-7b on cuda:0...
[OpenVLA] Step 1/4: Loading processor...
<frozen importlib._bootstrap>:283: DeprecationWarning: the load_module() method is deprecated and slated for removal in Python 3.12; use exec_module() instead
[OpenVLA] ✓ Processor loaded
[OpenVLA] Step 2/4: Loading model weights...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  4.81it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  5.55it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  6.06it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  5.83it/s]
[OpenVLA] ✓ Model weights loaded
[OpenVLA] Step 3/4: Moving model to cuda:0...
[OpenVLA] ✓ Model moved to cuda:0
[OpenVLA] Step 4/4: Getting action dimension...
[OpenVLA] ✓ Model loaded successfully
[OpenVLA] Action dim: 7
✓ Model loaded in 9.3s

[2/3] Loading adversarial patch...
✓ Patch loaded: (32, 32, 3), range [0.300, 0.700]
  Patch position: (48, 48)

[3/3] Running closed-loop evaluation...

================================================================================
Evaluating Task 0 from libero_spatial
================================================================================
[info] using task orders [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Task Name: pick_up_the_black_bowl_between_the_plate_and_the_ramekin_and_place_it_on_the_plate
Instruction: pick up the black bowl between the plate and the ramekin and place it on the plate
  Using fallback BDDL path: /data1/ma1/envs/upa-vla/lib/python3.10/site-packages/libero/libero/bddl_files/libero_spatial/pick_up_the_black_bowl_between_the_plate_and_the_ramekin_and_place_it_on_the_plate.bddl

[CLEAN POLICY] Running 50 episodes...
Local assets not found. Downloading from HuggingFace Hub...
Assets already downloaded at /data1/ma1/.cache/libero/assets
  Episode 1/50: Success rate so far: 0/1 (0.0%)
  Episode 10/50: Success rate so far: 0/10 (0.0%)
  Episode 20/50: Success rate so far: 0/20 (0.0%)
  Episode 30/50: Success rate so far: 0/30 (0.0%)
  Episode 40/50: Success rate so far: 0/40 (0.0%)
  Episode 50/50: Success rate so far: 0/50 (0.0%)
[CLEAN POLICY] Completed in 7737.7s
[CLEAN POLICY] Success Rate: 0.0% (0/50)

[ATTACKED POLICY] Running 50 episodes...
  Episode 1/50: Success rate so far: 0/1 (0.0%)
  Episode 10/50: Success rate so far: 0/10 (0.0%)
  Episode 20/50: Success rate so far: 0/20 (0.0%)
  Episode 30/50: Success rate so far: 0/30 (0.0%)
  Episode 40/50: Success rate so far: 0/40 (0.0%)
  Episode 50/50: Success rate so far: 0/50 (0.0%)
[ATTACKED POLICY] Completed in 7672.4s
[ATTACKED POLICY] Success Rate: 0.0% (0/50)

================================================================================
AGGREGATE RESULTS ACROSS ALL TASKS
================================================================================

Mean Clean Success Rate: 0.0% ± 0.0%
Mean Attacked Success Rate: 0.0% ± 0.0%
Mean TRUE ASR: 0.0% ± 0.0%

✓ Results saved: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/closed_loop/cl_baseline_task0_20260121_033842_results.json

================================================================================
FINAL VERDICT - CLOSED-LOOP EVALUATION
================================================================================
✗ INEFFECTIVE ATTACK (TRUE ASR: 0.0%)
    Attack does not cause significant task failure. Needs improvement.
================================================================================

End time: 2026-01-21 10:25:34
✅ Baseline closed-loop evaluation complete

[4b] Evaluating GRIPPER-FOCUSED patch...
[robosuite WARNING] No private macro file found! (__init__.py:7)
[robosuite WARNING] It is recommended to use a private macro file (__init__.py:8)
[robosuite WARNING] To setup, run: python /data1/ma1/envs/upa-vla/lib/python3.10/site-packages/robosuite/scripts/setup_macros.py (__init__.py:9)
✓ Successfully imported LIBERO
================================================================================
CLOSED-LOOP LIBERO EVALUATION - THE CRITICAL TEST
================================================================================
Experiment: cl_gripper_task0_20260121_033842
Start time: 2026-01-21 10:25:41
Suite: libero_spatial
Tasks: [0]
Clean episodes per task: 50
Attacked episodes per task: 50
Max steps per episode: 300
================================================================================

[1/3] Loading OpenVLA model...
[OpenVLA] Loading model from /data1/ma1/Ishaq/ump-vla/checkpoints/openvla-7b on cuda:0...
[OpenVLA] Step 1/4: Loading processor...
<frozen importlib._bootstrap>:283: DeprecationWarning: the load_module() method is deprecated and slated for removal in Python 3.12; use exec_module() instead
[OpenVLA] ✓ Processor loaded
[OpenVLA] Step 2/4: Loading model weights...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  4.88it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  5.64it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  6.18it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  5.95it/s]
[OpenVLA] ✓ Model weights loaded
[OpenVLA] Step 3/4: Moving model to cuda:0...
[OpenVLA] ✓ Model moved to cuda:0
[OpenVLA] Step 4/4: Getting action dimension...
[OpenVLA] ✓ Model loaded successfully
[OpenVLA] Action dim: 7
✓ Model loaded in 9.3s

[2/3] Loading adversarial patch...
✓ Patch loaded: (32, 32, 3), range [0.300, 0.700]
  Patch position: (48, 48)

[3/3] Running closed-loop evaluation...

================================================================================
Evaluating Task 0 from libero_spatial
================================================================================
[info] using task orders [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Task Name: pick_up_the_black_bowl_between_the_plate_and_the_ramekin_and_place_it_on_the_plate
Instruction: pick up the black bowl between the plate and the ramekin and place it on the plate
  Using fallback BDDL path: /data1/ma1/envs/upa-vla/lib/python3.10/site-packages/libero/libero/bddl_files/libero_spatial/pick_up_the_black_bowl_between_the_plate_and_the_ramekin_and_place_it_on_the_plate.bddl

[CLEAN POLICY] Running 50 episodes...
Local assets not found. Downloading from HuggingFace Hub...
Assets already downloaded at /data1/ma1/.cache/libero/assets
  Episode 1/50: Success rate so far: 0/1 (0.0%)
  Episode 10/50: Success rate so far: 0/10 (0.0%)
  Episode 20/50: Success rate so far: 0/20 (0.0%)
  Episode 30/50: Success rate so far: 0/30 (0.0%)
  Episode 40/50: Success rate so far: 0/40 (0.0%)
  Episode 50/50: Success rate so far: 0/50 (0.0%)
[CLEAN POLICY] Completed in 7928.5s
[CLEAN POLICY] Success Rate: 0.0% (0/50)

[ATTACKED POLICY] Running 50 episodes...
  Episode 1/50: Success rate so far: 0/1 (0.0%)
  Episode 10/50: Success rate so far: 0/10 (0.0%)
  Episode 20/50: Success rate so far: 0/20 (0.0%)
  Episode 30/50: Success rate so far: 0/30 (0.0%)
  Episode 40/50: Success rate so far: 0/40 (0.0%)
  Episode 50/50: Success rate so far: 0/50 (0.0%)
[ATTACKED POLICY] Completed in 7718.5s
[ATTACKED POLICY] Success Rate: 0.0% (0/50)

================================================================================
AGGREGATE RESULTS ACROSS ALL TASKS
================================================================================

Mean Clean Success Rate: 0.0% ± 0.0%
Mean Attacked Success Rate: 0.0% ± 0.0%
Mean TRUE ASR: 0.0% ± 0.0%

✓ Results saved: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/closed_loop/cl_gripper_task0_20260121_033842_results.json

================================================================================
FINAL VERDICT - CLOSED-LOOP EVALUATION
================================================================================
✗ INEFFECTIVE ATTACK (TRUE ASR: 0.0%)
    Attack does not cause significant task failure. Needs improvement.
================================================================================

End time: 2026-01-21 14:46:37
✅ Gripper closed-loop evaluation complete

STEP 4 completed in 31089s (518 minutes)

============================================================================================================
STEP 5/5: GENERATE VALIDATION REPORT
============================================================================================================

================================================================================
FULL VALIDATION PIPELINE REPORT
================================================================================
Pipeline: full_validation_libero_spatial_20260121_033842
Date: Wed Jan 21 14:46:38 +03 2026
Suite: libero_spatial
Tasks: 0

================================================================================
TIMING SUMMARY
================================================================================
Step 1 (Clean Baseline):        7858s (130 min)
Step 2 (Train Baseline):         569s (9 min)
Step 3 (Train Gripper):          560s (9 min)
Step 4 (Closed-Loop Eval):       31089s (518 min)
Total:                           40076s (667 min)

================================================================================
FILES GENERATED
================================================================================

Patches (Baseline):
  Task 0: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/baseline_patch_task0_20260121_033842_20260121_054946_patch.npy

Patches (Gripper-Focused):
  Task 0: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/patches/gripper_focused_task0_20260121_033842_20260121_055913_patch.npy

Closed-Loop Results:
  Directory: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/closed_loop
  Files: cl_*_20260121_033842_results.json

================================================================================
NEXT STEPS
================================================================================

1. Review closed-loop results:
   ls -lh /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/closed_loop/*_20260121_033842_results.json

2. Compare baseline vs gripper-focused:
   - Check TRUE ASR for both approaches
   - Verify if gripper weight increase improved results

3. Analyze Direction 2 hypothesis:
   - Does TRUE ASR > single-frame ASR?
   - Is cumulative drift correlated with task failure?

4. If TRUE ASR >= 60%:
   ✅ Direction 2 validated! Ready for ECCV paper.

   If TRUE ASR 40-60%:
   ⚠️  Moderate results. Consider improvements (V3 optimizations).

   If TRUE ASR < 40%:
   ❌ Hypothesis needs revision. Investigate failure modes.

================================================================================
PRIORITY ACTIONS BASED ON RESULTS
================================================================================

IF TRUE ASR > 60% (Strong Attack):
  1. Run on all 10 tasks (3 seeds each)
  2. Start writing ECCV paper
  3. Focus on analysis and comparison sections

IF TRUE ASR 40-60% (Moderate Attack):
  1. Implement V3 optimizer improvements (Improvements 4 & 6)
  2. Try larger patch sizes (48×48, 64×64)
  3. Re-run closed-loop evaluation

IF TRUE ASR < 40% (Weak Attack):
  1. Analyze failure modes (why aren't tasks failing?)
  2. Test position-only vs gripper-only attacks
  3. Consider pivot to different attack objective

================================================================================
VALIDATION CHECKLIST
================================================================================

Priority 1 (CRITICAL):
  [✓] Closed-loop evaluation implemented
  [✓] Task success rates measured
  [ ] TRUE ASR computed and compared to single-frame ASR

Priority 2 (IMPORTANT):
  [✓] Drift calculations verified (actual vs legacy)
  [ ] Drift consistency checked (oscillation detection)

Priority 3 (IMPORTANT):
  [✓] Gripper-focused attack tested
  [ ] Gripper flip rate improvement confirmed

================================================================================
END OF REPORT
================================================================================

============================================================================================================
FULL VALIDATION PIPELINE COMPLETE
============================================================================================================
Total time: 667 minutes
Report saved: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/logs/full_validation_libero_spatial_20260121_033842_report.txt
Pipeline log: /data1/ma1/Ishaq/ump-vla/outputs/se3_zoo_attack/logs/full_validation_libero_spatial_20260121_033842.log
============================================================================================================

